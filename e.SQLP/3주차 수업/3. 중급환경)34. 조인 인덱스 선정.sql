ALTER SESSION SET WORKAREA_SIZE_POLICY  = MANUAL;
ALTER SESSION SET SORT_AREA_SIZE = 2000000000;

DROP   TABLE YOON.T1_34;
CREATE TABLE YOON.T1_34 NOLOGGING AS
SELECT ROWNUM C1, TRUNC(DBMS_RANDOM.VALUE(1, 10000)) C2, '1234567890' C3, '0987654321' C4, ALPHA C5
FROM (
    select CHR(ascii('A') + TRUNC(DBMS_RANDOM.VALUE(1, 25))) ALPHA from dual
    connect by level <= 5000000
    union all
    select CHR(ascii('a') + TRUNC(DBMS_RANDOM.VALUE(1, 25))) ALPHA from dual
    connect by level <= 5000000
    )
ORDER BY DBMS_RANDOM.RANDOM()
;

CREATE PUBLIC SYNONYM T1_34 FOR YOON.T1_34;

INSERT INTO T1_34
SELECT 10000000+ROWNUM C1, TRUNC(DBMS_RANDOM.VALUE(1, 10000)) C2, '1234567890' C3, '0987654321' C4, 'A' C5
FROM DUAL
CONNECT BY LEVEL <= 100
ORDER BY DBMS_RANDOM.RANDOM()
;

COMMIT;

DROP TABLE YOON.T2_34 ;
CREATE TABLE YOON.T2_34 NOLOGGING AS
SELECT rownum SNO, T1.C1, TRUNC(DBMS_RANDOM.VALUE(1, 200)) C2, TRUNC(DBMS_RANDOM.VALUE(1, 500)) C3, '0987654321' C4
FROM T1_34 T1, (SELECT LEVEL FROM DUAL CONNECT BY LEVEL <= 10)
ORDER BY DBMS_RANDOM.RANDOM()
;

CREATE PUBLIC SYNONYM T2_34 FOR YOON.T2_34;

CREATE INDEX YOON.IX_T1_34_01
ON YOON.T1_34(C5);

DROP INDEX YOON.IX_T2_34_03;
CREATE INDEX YOON.IX_T2_34_03
ON YOON.T2_34(C1);

UPDATE /*+ INDEX( T2 IX_T2_34_03) */ T2_34 T2
SET C2 = 10, 
    C3 = 123
WHERE C1 IN (SELECT /*+ INDEX(A IX_T1_34_01) */ C1 FROM T1_34 A WHERE C5='A');

COMMIT;

EXECUTE DBMS_STATS.GATHER_TABLE_STATS('YOON', 'T1_34');
EXECUTE DBMS_STATS.GATHER_TABLE_STATS('YOON', 'T2_34');

ALTER SESSION SET WORKAREA_SIZE_POLICY = AUTO;
